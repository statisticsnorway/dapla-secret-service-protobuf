syntax = "proto3";

option java_multiple_files = true;
option java_package = "no.ssb.dapla.secret.service.protobuf";

service SecretService {
    rpc GetKey (GetKeyRequest) returns (GetKeyResponse);
    rpc CreateKey (CreateKeyRequest) returns (CreateKeyResponse);
    rpc DeleteKey (DeleteKeyRequest) returns (DeleteKeyResponse);
    rpc CreateOrGetKey (CreateOrGetKeyRequest) returns (CreateOrGetKeyResponse);
}

message PseudoKey {
    string key = 1;
}

message GetKeyRequest {
    string keyId = 1;
    string type = 2;
    string namespace = 3;
    string state = 4;
    string valuation = 5;
    string privilege = 6;
}

message GetKeyResponse {
    string keyId = 1;
    string type = 2;
    PseudoKey key = 3;
}

message CreateKeyRequest {
    string keyId = 1;
    PseudoKey key = 2;
}

message CreateKeyResponse {
    string keyId = 1;
}

message DeleteKeyRequest {
    string keyId = 1;
}

message DeleteKeyResponse {
    int32 rowsAffected = 1;
}

message CreateOrGetKeyRequest {
    string keyId = 1;
    string type = 2;
    string namespace = 3;
    string state = 4;
    string valuation = 5;
    string privilege = 6;
}

message CreateOrGetKeyResponse {
    string keyId = 1;
    string type = 2;
    PseudoKey key = 3;
}
